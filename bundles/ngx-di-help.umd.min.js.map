{"version":3,"sources":["ng://ngx-di-help/lib/di-help.config.ts","ng://ngx-di-help/lib/api/di-help.service.ts","ng://ngx-di-help/lib/di-help/di-help.component.ts","ng://ngx-di-help/lib/di-help/di-help.module.ts","ng://ngx-di-help/lib/di-help-faq/di-help-faq.component.ts","ng://ngx-di-help/lib/di-help-faq/di-help-faq.module.ts"],"names":["DI_HELP_URL_TOKEN","InjectionToken","DI_HELP_CACHE_LIFETIME_TOKEN","DiHelpService","diHelpUrlResolver","diHelpUrl","cacheLifetimeSecond","http","this","cacheById","requestCacheById","cacheByUid","requestCacheByUid","cacheByUrl","requestCacheByUrl","resolved","resolve","of","isObservable","Error","cacheLifetime","prototype","getArticleById","id","_this","pipe","flatMap","baseAddress","cachedGet","getArticleByUrl","url","encodeURIComponent","getArticleByUid","siteUrl","uid","getFaqBySiteId","get","headers","ignoreLoadingBar","map","a","getFaqBySiteUrl","cache","requestCache","key","httpUrl","error","throwError","article","tap","catchError","e","finalize","setTimeout","share","Injectable","DiHelpUrlResolver","Inject","args","HttpClient","DiHelpComponent","diHelpService","router","changeDetector","alwaysVisible","inline","Object","defineProperty","_articleId","value","byLocation","articleUid","subscribe","markForCheck","_articleUid","articleId","location","origin","_byLocation","updateFromLocation","routerEventsSubscription","events","filter","event","NavigationEnd","unsubscribe","ngOnDestroy","pathname","Component","selector","template","changeDetection","ChangeDetectionStrategy","OnPush","Router","ChangeDetectorRef","Input","DiHelpModule","forRoot","config","ngModule","providers","provide","useValue","isNaN","NgModule","imports","CommonModule","NgxPopperModule","declarations","exports","DiHelpFaqComponent","_siteId","articles","allArticles","applyFilter","ngOnInit","siteId","query_1","toLowerCase","Name","includes","ShortText","DiHelpFiles","some","f","Links","l","DiHelpFaqModule"],"mappings":"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","sourcesContent":["import { Provider, InjectionToken } from '@angular/core';\r\nimport { Observable } from 'rxjs';\r\n\r\nexport abstract class DiHelpUrlResolver {\r\n    abstract resolve(): string | Observable<string>;\r\n}\r\n\r\nexport interface DiHelpConfig {\r\n    diHelpUrl?: string;\r\n    diHelpUrlResolver?: Provider;\r\n    cacheLifetimeSecond?: number,\r\n}\r\n\r\nexport const DI_HELP_URL_TOKEN = new InjectionToken<string>('DI_HELP_URL');\r\nexport const DI_HELP_CACHE_LIFETIME_TOKEN = new InjectionToken<string>('DI_HELP_CACHE_LIFETIME');\r\n","import { Injectable, Inject } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Observable, of, throwError, isObservable } from 'rxjs';\r\nimport { map, catchError, tap, share, finalize, flatMap } from 'rxjs/operators';\r\nimport { ArticleClientDto } from './article-client-dto';\r\nimport { DiHelpUrlResolver, DI_HELP_URL_TOKEN, DI_HELP_CACHE_LIFETIME_TOKEN } from '../di-help.config';\r\n\r\ninterface ICacheEntry {\r\n    article?: ArticleClientDto;\r\n    error?: any;\r\n}\r\n\r\nexport const cacheLifetimeSecondDefault = 30 * 60;\r\n\r\n@Injectable()\r\nexport class DiHelpService {\r\n\r\n    private readonly cacheLifetime: number;\r\n\r\n    private readonly cacheById: { [id: number]: ICacheEntry } = {};\r\n    private readonly requestCacheById: { [id: number]: Observable<ArticleClientDto> } = {};\r\n    private readonly cacheByUid: { [uid: string]: ICacheEntry } = {};\r\n    private readonly requestCacheByUid: { [uid: string]: Observable<ArticleClientDto> } = {};\r\n    private readonly cacheByUrl: { [url: string]: ICacheEntry } = {};\r\n    private readonly requestCacheByUrl: { [url: string]: Observable<ArticleClientDto> } = {};\r\n\r\n    private readonly diHelpUrl: Observable<string>;\r\n\r\n    constructor(\r\n        diHelpUrlResolver: DiHelpUrlResolver,\r\n        @Inject(DI_HELP_URL_TOKEN) diHelpUrl: string,\r\n        @Inject(DI_HELP_CACHE_LIFETIME_TOKEN) cacheLifetimeSecond: number,\r\n        private readonly http: HttpClient,\r\n    ) {\r\n        if (diHelpUrlResolver) {\r\n            const resolved = diHelpUrlResolver.resolve();\r\n            if (typeof resolved === 'string') {\r\n                this.diHelpUrl = of(resolved);\r\n            } else if (isObservable(resolved)) {\r\n                this.diHelpUrl = resolved;\r\n            } else {\r\n                throw Error('Not supported diHelpUrlResolver');\r\n            }\r\n        } else if (diHelpUrl) {\r\n            this.diHelpUrl = of(diHelpUrl);\r\n        } else {\r\n            throw Error('Please, configure diHelpUrl or diHelpUrlResolver');\r\n        }\r\n\r\n        this.cacheLifetime = cacheLifetimeSecond * 1000;\r\n    }\r\n\r\n    getArticleById(id: number): Observable<ArticleClientDto> {\r\n        return this.diHelpUrl.pipe(flatMap(baseAddress => this.cachedGet(\r\n            this.cacheById,\r\n            this.requestCacheById,\r\n            id,\r\n            `${baseAddress}/api/Articles/GetArticleById/${id}`)));\r\n    }\r\n\r\n    getArticleByUrl(url: string): Observable<ArticleClientDto> {\r\n        return this.diHelpUrl.pipe(flatMap(baseAddress => this.cachedGet(\r\n            this.cacheByUrl,\r\n            this.requestCacheByUrl,\r\n            url,\r\n            `${baseAddress}/api/Articles/GetArticleByUrl/?url=${encodeURIComponent(url)}`)));\r\n    }\r\n\r\n    getArticleByUid(siteUrl: string, uid: string): Observable<ArticleClientDto> {\r\n        return this.diHelpUrl.pipe(flatMap(baseAddress => this.cachedGet(\r\n            this.cacheByUid,\r\n            this.requestCacheByUid,\r\n            uid,\r\n            `${baseAddress}/api/Articles/GetArticleByUid/?siteUrl=${encodeURIComponent(siteUrl)}&uid=${encodeURIComponent(uid)}`)));\r\n    }\r\n\r\n    getFaqBySiteId(id: number): Observable<ArticleClientDto[]> {\r\n        return this.diHelpUrl.pipe(flatMap(baseAddress => this.http\r\n            .get(`${baseAddress}/api/Articles/GetFaqBySiteId/${id}`, {\r\n                headers: { ignoreLoadingBar: '' }\r\n            })\r\n            .pipe(map(a => a as ArticleClientDto[]))));\r\n    }\r\n\r\n    getFaqBySiteUrl(siteUrl: string): Observable<ArticleClientDto[]> {\r\n        return this.diHelpUrl.pipe(flatMap(baseAddress => this.http\r\n            .get(`${baseAddress}/api/Articles/GetFaqBySiteUrl/?siteUrl=${encodeURIComponent(siteUrl)}`, {\r\n                headers: { ignoreLoadingBar: '' }\r\n            })\r\n            .pipe(map(a => a as ArticleClientDto[]))));\r\n    }\r\n\r\n    private cachedGet(\r\n        cache: { [id: number]: ICacheEntry } | { [url: string]: ICacheEntry },\r\n        requestCache: { [id: number]: Observable<ArticleClientDto> } | { [id: number]: Observable<ArticleClientDto> },\r\n        key: number | string,\r\n        httpUrl: string\r\n    ): Observable<ArticleClientDto> {\r\n        if (cache[key]) {\r\n            return cache[key].error ? throwError(cache[key].error) : of(cache[key].article);\r\n        }\r\n\r\n        if (requestCache[key]) return requestCache[key];\r\n\r\n        requestCache[key] = this.http\r\n            .get(httpUrl, {\r\n                headers: { ignoreLoadingBar: '' }\r\n            })\r\n            .pipe(\r\n                map(a => a as ArticleClientDto),\r\n                tap(a => {\r\n                    delete requestCache[key];\r\n                    cache[key] = {\r\n                        article: a,\r\n                    };\r\n                }),\r\n                catchError(e => {\r\n                    delete requestCache[key];\r\n                    cache[key] = {\r\n                        error: e,\r\n                    };\r\n                    return throwError(e);\r\n                }),\r\n                finalize(() => {\r\n                    setTimeout(() => delete cache[key], this.cacheLifetime);\r\n                }),\r\n                share());\r\n\r\n        return requestCache[key];\r\n    }\r\n}\r\n","import { Component, Input, OnDestroy, ChangeDetectionStrategy, ChangeDetectorRef } from '@angular/core';\r\nimport { Router, NavigationEnd } from '@angular/router';\r\nimport { Subscription } from 'rxjs';\r\nimport { filter } from 'rxjs/operators';\r\nimport { IArticleClientDto } from '../api/article-client-dto';\r\nimport { DiHelpService } from '../api/di-help.service';\r\n\r\n@Component({\r\n    selector: 'di-help',\r\n    templateUrl: './di-help.template.html',\r\n    styleUrls: ['./di-help.style.scss'],\r\n    changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class DiHelpComponent implements OnDestroy {\r\n\r\n    article: IArticleClientDto;\r\n\r\n    private routerEventsSubscription: Subscription;\r\n    private _articleId: number;\r\n    private _articleUid: string;\r\n    private _byLocation: boolean;\r\n\r\n    @Input()\r\n    get articleId(): number {\r\n        return this._articleId;\r\n    }\r\n    set articleId(value: number) {\r\n        if (this.byLocation) throw Error('Do not use article-id with by-location');\r\n        if (this.articleUid) throw Error('Do not use article-id with article-uid');\r\n\r\n        if (this._articleId === value) return;\r\n\r\n        this._articleId = value;\r\n\r\n        if (!value) return;\r\n        this.diHelpService.getArticleById(value)\r\n            .subscribe(article => {\r\n                this.article = article;\r\n                this.changeDetector.markForCheck();\r\n            }, () => {\r\n                this.article = null;\r\n                this.changeDetector.markForCheck();\r\n            });\r\n    }\r\n\r\n    @Input()\r\n    get articleUid(): string {\r\n        return this._articleUid;\r\n    }\r\n    set articleUid(value: string) {\r\n        if (this.byLocation) throw Error('Do not use article-uid with by-location');\r\n        if (this.articleId) throw Error('Do not use article-uid with article-id');\r\n\r\n        if (this._articleUid === value) return;\r\n\r\n        this._articleUid = value;\r\n\r\n        if (!value) return;\r\n        this.diHelpService.getArticleByUid(location.origin, value)\r\n            .subscribe(article => {\r\n                this.article = article;\r\n                this.changeDetector.markForCheck();\r\n            }, () => {\r\n                this.article = null;\r\n                this.changeDetector.markForCheck();\r\n            });\r\n    }\r\n\r\n    @Input()\r\n    get byLocation(): boolean {\r\n        return this._byLocation;\r\n    }\r\n    set byLocation(value: boolean) {\r\n        if (this.articleId) throw Error('Do not use by-location with article-id');\r\n        if (this.articleUid) throw Error('Do not use by-location with article-uid');\r\n\r\n        if (this._byLocation === value) return;\r\n\r\n        this._byLocation = value;\r\n\r\n        if (value) {\r\n            this.updateFromLocation();\r\n            this.routerEventsSubscription = this.router.events\r\n                .pipe(filter(event => event instanceof NavigationEnd))\r\n                .subscribe(() => {\r\n                    this.updateFromLocation();\r\n                });\r\n        } else {\r\n            if (this.routerEventsSubscription) {\r\n                this.routerEventsSubscription.unsubscribe();\r\n            }\r\n        }\r\n    }\r\n\r\n    @Input()\r\n    alwaysVisible: boolean = true;\r\n\r\n    @Input()\r\n    inline: boolean = false;\r\n\r\n    constructor(\r\n        private readonly diHelpService: DiHelpService,\r\n        private readonly router: Router,\r\n        private readonly changeDetector: ChangeDetectorRef\r\n    ) { }\r\n\r\n    ngOnDestroy(): void {\r\n        if (this.routerEventsSubscription) {\r\n            this.routerEventsSubscription.unsubscribe();\r\n        }\r\n    }\r\n\r\n    private updateFromLocation(): void {\r\n        this.diHelpService.getArticleByUrl(location.origin + location.pathname)\r\n            .subscribe(article => {\r\n                this.article = article;\r\n                this.changeDetector.markForCheck();\r\n            }, () => {\r\n                this.article = null;\r\n                this.changeDetector.markForCheck();\r\n            });\r\n    }\r\n}\r\n","import { NgModule, ModuleWithProviders } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { NgxPopperModule } from 'ngx-popper';\r\nimport { DiHelpComponent } from './di-help.component';\r\nimport { DiHelpService, cacheLifetimeSecondDefault } from '../api/di-help.service';\r\nimport { DiHelpConfig, DI_HELP_URL_TOKEN, DI_HELP_CACHE_LIFETIME_TOKEN } from '../di-help.config';\r\nimport { DiHelpUrlResolver } from '../di-help.config';\r\n\r\n@NgModule({\r\n    imports: [\r\n        CommonModule,\r\n        NgxPopperModule\r\n    ],\r\n    declarations: [\r\n        DiHelpComponent\r\n    ],\r\n    exports: [\r\n        DiHelpComponent\r\n    ]\r\n})\r\nexport class DiHelpModule {\r\n    static forRoot(config: DiHelpConfig): ModuleWithProviders {\r\n        return {\r\n            ngModule: DiHelpModule,\r\n            providers: [\r\n                config.diHelpUrlResolver || { provide: DiHelpUrlResolver, useValue: null },\r\n                {\r\n                    provide: DI_HELP_URL_TOKEN,\r\n                    useValue: config.diHelpUrl,\r\n                },\r\n                {\r\n                    provide: DI_HELP_CACHE_LIFETIME_TOKEN,\r\n                    useValue: isNaN(config.cacheLifetimeSecond) ? cacheLifetimeSecondDefault : config.cacheLifetimeSecond,\r\n                },\r\n                DiHelpService\r\n            ]\r\n        };\r\n    }\r\n}\r\n","import { Component, Input, OnInit } from '@angular/core';\r\nimport { IArticleClientDto } from '../api/article-client-dto';\r\nimport { DiHelpService } from '../api/di-help.service';\r\n\r\n@Component({\r\n    selector: 'di-help-faq',\r\n    templateUrl: './di-help-faq.template.html'\r\n})\r\nexport class DiHelpFaqComponent implements OnInit {\r\n\r\n    articles: IArticleClientDto[];\r\n\r\n    private _siteId: number;\r\n    private allArticles: IArticleClientDto[];\r\n\r\n    @Input()\r\n    get siteId(): number {\r\n        return this._siteId;\r\n    }\r\n    set siteId(value: number) {\r\n        if (this._siteId === value) return;\r\n\r\n        this._siteId = value;\r\n\r\n        if (!value) return;\r\n        this.diHelpService.getFaqBySiteId(value).subscribe(articles => {\r\n            this.allArticles = articles;\r\n            this.applyFilter();\r\n        }, () => {\r\n            this.allArticles = null;\r\n            this.applyFilter();\r\n        });\r\n    }\r\n\r\n    constructor(private readonly diHelpService: DiHelpService) { }\r\n\r\n    ngOnInit(): void {\r\n        if (!this.siteId) {\r\n            this.diHelpService.getFaqBySiteUrl(location.origin).subscribe(articles => {\r\n                this.allArticles = articles;\r\n                this.applyFilter();\r\n            }, () => {\r\n                this.allArticles = null;\r\n                this.applyFilter();\r\n            });\r\n        }\r\n    }\r\n\r\n    applyFilter(filter: string = '') {\r\n        if (filter) {\r\n            const query = filter.toLowerCase();\r\n            this.articles = this.allArticles.filter(a =>\r\n                a.Name.toLowerCase().includes(query)\r\n                || a.ShortText.toLowerCase().includes(query)\r\n                || (a.DiHelpFiles && a.DiHelpFiles.some(f => f.Name.toLowerCase().includes(query)))\r\n                || (a.Links && a.Links.some(l => l.Name.toLowerCase().includes(query))));\r\n        } else {\r\n            this.articles = this.allArticles;\r\n        }\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { DiHelpFaqComponent } from './di-help-faq.component';\r\nimport { DiHelpService } from '../api/di-help.service';\r\nimport { DiHelpModule } from '../di-help/di-help.module';\r\n\r\n@NgModule({\r\n    imports: [\r\n        CommonModule,\r\n        DiHelpModule\r\n    ],\r\n    declarations: [\r\n        DiHelpFaqComponent\r\n    ],\r\n    exports: [\r\n        DiHelpFaqComponent\r\n    ],\r\n    providers: [\r\n        DiHelpService\r\n    ]\r\n})\r\nexport class DiHelpFaqModule { }\r\n"]}